@use '../../../globals/vars' as *;
@use '@carbon/react/scss/layout' as *;
@use 'column-resize' as *;

@use 'ColumnGrouping/column-grouping' as *;
@use '@carbon/react/scss/config' as *;
@use '@carbon/react/scss/theme' as *;
@use '@carbon/react/scss/spacing' as *;
@use '@carbon/react/scss/colors' as *;
@use '@carbon/react/scss/components/button' as *;
@use '../../../globals/mixins' as *;
@use '@carbon/react/scss/components/data-table' as *;
@use 'ColumnHeaderRow/column-header-row' as *;
@use 'FilterHeaderRow/filter-header-row' as *;
@use '@carbon/react/scss/components/data-table/sort' as *;

.#{$prefix}--data-table {
  th {
    height: $spacing-09;
    border-top: none;
    border-bottom: none;
    position: relative;

    // always vertically align headers to middle--even with xl size prop
    &.#{$iot-prefix}--table-head--table-header {
      vertical-align: middle;
    }
  }

  th[aria-sort] {
    padding-left: 1rem;
  }

  // override sort icons, so they stay in the middle, at xl size, too.
  &--xl {
    .#{$prefix}--table-sort__icon-unsorted,
    .#{$prefix}--table-sort__icon {
      margin-top: 0;
    }

    // fix positioning of order number when in multi-sort
    span.#{$iot-prefix}--table-header-label__sort-order {
      bottom: $spacing-05 + $spacing-02;
    }

    // fix sort icon missing at xl sizes
    &.#{$prefix}--data-table--sort th .#{$prefix}--table-sort {
      display: flex;
    }

    th,
    th[aria-sort] {
      height: $spacing-10;
    }

    .#{$prefix}--table-header-label {
      padding-top: 0;
      padding-bottom: 0;
    }
  }

  &--md {
    th,
    th[aria-sort] {
      height: $spacing-08;
    }

    .#{$prefix}--table-header-label {
      padding-top: 0;
      padding-bottom: 0;
    }
  }

  &--sm {
    th,
    th[aria-sort] {
      height: $spacing-07;
    }

    .#{$prefix}--table-header-label {
      padding-top: 0;
      padding-bottom: 0;
    }
  }

  &--xs {
    th,
    th[aria-sort] {
      height: $spacing-06;
    }

    .#{$prefix}--table-header-label {
      padding-top: 0;
      padding-bottom: 0;
    }
  }

  th:last-of-type {
    position: relative;
  }

  .#{$prefix}--table-header-label {
    display: flex;
    user-select: none;
    overflow: hidden;
    // allow the multiselect filter to expand to full height and the table to scroll
    .#{$prefix}--multi-select .#{$prefix}--list-box__menu {
      max-height: unset;
    }

    & > span {
      margin: auto 0;
      flex-grow: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      line-height: 1.1rem;
    }
  }

  .#{$iot-prefix}--table-header-label__sort-order {
    position: absolute;
    bottom: $spacing-04;
    right: $spacing-02;
    font-size: 0.667rem;
    font-weight: bold;

    html[dir='rtl'] & {
      left: $spacing-05;
      right: unset;
    }
  }

  .column-header__btn {
    margin: 0 $spacing-05 $spacing-05 0;
    max-height: $spacing-07;
  }

  .column-header__select {
    opacity: 1;
  }

  .column-header__select--hidden {
    opacity: 0.5;
  }

  .column-header__select--isOver {
    border-color: $focus;
    box-shadow: inset 0 0 0 1px $gray-10;
  }

  .lightweight {
    tr:last-of-type {
      th {
        border-bottom: solid 2px $button-secondary;
      }
    }
    th {
      background-color: $layer-01;
      .#{$prefix}--table-sort {
        background-color: $layer-01;
        &:hover {
          background-color: $layer-accent-01;
        }
      }
    }
  }

  .#{$iot-prefix}--table-expand-resize {
    width: 40px;
  }

  .#{$iot-prefix}--table-header-checkbox {
    vertical-align: middle;
    .#{$prefix}--table-header-label {
      overflow: visible;
    }
  }

  .#{$iot-prefix}--table-header-radiobutton {
    vertical-align: middle;
    .#{$prefix}--table-header-label {
      overflow: visible;
    }
  }

  .#{$iot-prefix}--table-header-checkbox-resize {
    width: 54px;
  }

  .#{$iot-prefix}--table-header-radiobutton-resize {
    width: 54px;
  }

  .#{$iot-prefix}--table-header-resize {
    word-break: break-all;
  }

  .#{$iot-prefix}--table-header-row-action-column {
    min-width: 40px;
  }

  .#{$iot-prefix}--table-header-expander-column {
    width: auto;
    padding: 0;
  }

  .#{$iot-prefix}--tableheader-filter > .#{$prefix}--table-header-label {
    overflow: visible;
  }

  th:last-of-type.#{$iot-prefix}--table-header-row-action-column--extra-wide {
    min-width: 250px;
    width: 250px; // Needed for fixed/resizable columns that don't respect min-width
  }

  .#{$iot-prefix}--clear-filters-button--disabled {
    @include disabled-icon-button();
  }

  .#{$prefix}--table-sort {
    padding-left: 0;
    padding-right: 0;

    .#{$prefix}--table-header-label,
    .#{$prefix}--tooltip--definition {
      padding-left: $spacing-05;
      padding-right: 0;

      [dir='rtl'] & {
        padding-left: unset;
        padding-right: $spacing-05;
      }
    }
  }
}

.#{$iot-prefix}--table-head {
  &--overflow {
    margin: auto 0;
    flex-shrink: 0;
    display: inline-flex;

    .#{$prefix}--table-sort:focus &:hover {
      margin-top: -2px;
      margin-bottom: -2px;
      background-color: $gray-40;
    }
  }

  &--table-header {
    position: relative;
    vertical-align: middle;

    .#{$prefix}--table-header-label {
      height: 100%;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;

      line-height: 1rem;
    }

    &--with-overflow {
      .#{$prefix}--table-header-label {
        padding-right: 0;
      }

      .#{$prefix}--overflow-menu-options:after {
        width: 3rem;
      }
    }
  }
}
